{% extends "base.html" %}

{% block title %}Deposit{% endblock %}

{% block content %}
<audio id="coinSound" src="{{ mm_url_for('static', filename='audio/coin.wav') }}" preload="auto"></audio>
<div id="flash-messages" style="position: fixed; top: 100px; left: 10px; z-index: 10000 !important;"></div>
<div class="container mt-5">
    <div class="jumbotron text-center py-4" style="background: linear-gradient(90deg, #1e3c72 0%, #2a5298 100%); color: #ffffff;">
        <h1 class="mb-3" style="font-size: 2.5rem;">Deposit</h1>

        <div class="alert alert-info" style="max-width: 800px; margin: 0 auto 20px;">
            <strong>üéâ Easy Demo Mode!</strong><br>
            Click the button below to get free demo tokens instantly for testing.
        </div>

        <form action="{{ mm_url_for('get_demo_tokens') }}" method="post">
            <button type="submit" class="btn btn-success btn-lg mb-3">
                üí∞ Get Demo Tokens (KSH, USDC, USDT, ETH, BTC, SOL)
            </button>
        </form>

        <hr style="border-color: rgba(255,255,255,0.3); max-width: 600px; margin: 20px auto;">

        <p style="font-size: 1.15rem;"><strong>XRP Testnet Deposit Address:</strong> rfwHCz6KcUuZafbzcxYGzVCBGKVske1dwk</p>
        <p style="font-size: 1.0rem;">For XRP only: Send test XRP from your testnet wallet to this address</p>
        <p style="font-size: 0.95rem; color: #ffc107;">‚ö†Ô∏è XRP is the only real testnet asset - others are demo tokens</p>

        <div class="alert alert-secondary" style="max-width: 800px; margin: 20px auto 0; font-size: 0.9rem;">
            <strong>Supported Assets:</strong> KSH (Kenyan Shilling), USDC, USDT, XRP, ETH, BTC, SOL
        </div>
        <p id="message" style="font-size: 1.15rem;"></p>
    </div>
</div>
<!-- JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.min.js"></script>
<script>
    var protocol = location.protocol;
    var ws_url = protocol + '//' + document.domain + (location.port ? ':' + location.port : '');
    var socket = io.connect(ws_url, {path: "/mm/socket.io"});

    socket.on('deposit', function(data) {
    // Displaying a message about the deposit
    var depositMessage = "Deposited " + data.amount + " " + data.asset;
    var depositMessageElement = document.createElement('div');
    depositMessageElement.classList.add('alert', 'alert-success');
    depositMessageElement.textContent = depositMessage;

    var flashMessagesContainer = document.getElementById('flash-messages');
    flashMessagesContainer.appendChild(depositMessageElement);

    // Play the coin sound
    document.getElementById('coinSound').play();

    // Set the timeout function within the scope of the event listener
    setTimeout(function() {
        flashMessagesContainer.removeChild(depositMessageElement);
    }, 5000);  // Removes the message after 5 seconds
});
</script>
{% endblock %}


